# ==============================================================================
# Configuration for vmdump.sh
# ==============================================================================

# --- Execution Mode ---
# Define the backup mode. Options are:
# - "remote": Use Controller Mode to back up VMs on remote nodes via SSH, as defined in VM_GROUPS.
# - "local":  Use Local Mode to back up specific VMs on this machine, as defined in LOCAL_VMS.
BACKUP_MODE="remote"

# --- General Settings ---
# Email address to send the report to.
RECIPIENT_EMAIL="admin@example.com"

# Directory to store the exported VM archives on the target node.
BACKUP_DIR="/var/backups/bhyve"

# Log file for the script's operations on the target node.
LOG_FILE="/var/log/bhyve_backup.log"

# --- bhyve-cli Settings ---
# Full path to the bhyve-cli executable on the target node.
BHYVE_CLI_PATH="/usr/local/sbin/bhyve-cli"

# --- Backup Process Settings ---
# Compression format: zst, gz, bz2, xz
COMPRESSION_FORMAT="zst"

# Export mode: --force-export, --suspend-export, --stop-export, or "" (empty)
EXPORT_MODE="--force-export"

# Retention policy: Number of backups to keep per VM. Set to 0 to disable.
RETENTION_COUNT=7

# --- Reporting Settings ---
# Reporting mode: "individual" or "summary".
# individual: Send one email per VM.
# summary:    Send one summary email per node.
REPORTING_MODE="summary"

# --- SSH Settings (for Controller Mode) ---
SSH_USER="foo"
SSH_PORT=202
SSH_KEY="/home/foo/.ssh/id_ed25519"

# --- VM Definitions (for Controller Mode) ---
# Use standard bash associative array syntax.
# The controller script will iterate through this list.
declare -A VM_GROUPS
VM_GROUPS=(
  ["node-south.example.net.id"]="vm-proxy"
  ["node-east.example.net.id"]="vm-vyos"
  ["node-north.example.net.id"]="vm-bird"
)

# --- VM Definitions (for Local Mode) ---
# A space-separated list of VM names to back up when BACKUP_MODE is "local".
# Example: LOCAL_VMS="vm-web vm-db vm-utility"
LOCAL_VMS=""
